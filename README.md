File Integrity Monitor (FIM)

File Integrity Monitor (FIM) — это десктоп‑приложение на C++, которое
предоставляет удобный интерфейс для анализа бинарных файлов и отслеживания их
целостности. Программа загружает произвольные файлы, вычисляет их хеш
(SHA‑256) и подписывает метаданные с помощью HMAC, отображает содержимое в виде
шестнадцатеричного просмотра (Hex Viewer), тепловой карты (Heatmap View) и
аудио‑интерпретации (Audio View), а также сохраняет историю сканирований и
параметры интерфейса в базе данных SQLite. Приложение разработано для
платформы Linux, графический интерфейс построен с использованием Qt 6 (Qt
Widgets), а для распространения используется формат AppImage.

Основные возможности

Загрузка бинарных файлов: пользователь выбирает файл через диалоговое
окно, после чего программа загружает данные и передаёт их в модуль ядра для
обработки.

Hex Viewer: отображает содержимое файла в таблице, где показаны смещение
байтов, значения в шестнадцатеричном виде и ASCII‑интерпретация.

Heatmap View: визуализирует распределение байт файла на тепловой карте;
пользователь может регулировать ширину карты, изменяя количество блоков
по горизонтали.

Audio View: воспроизводит содержимое файла как аудио‑поток; режим
позволяет оценить структуру данных в звуковой форме.

File Info: отображает общую информацию о файле (путь, размер,
расширение).

Настройки: пользователь может изменять тему интерфейса, параметры
тепловой карты и другие опции; значения сохраняются в базе данных и
загружаются при следующем запуске.

История сканирований: информация о загруженных файлах, дата и время,
значение хеша, изменение статуса и комментарии сохраняются в таблице
scan_history базы данных.

Поддержка HMAC: метаданные файла подписываются HMAC на основе SHA‑256.
Подпись помогает определить, были ли сведения о файле изменены после
сохранения. При загрузке запись считается корректной, если контрольная
подпись совпадает.

Архитектура и структура проекта

Приложение разделено на несколько модулей, что облегчает поддержку и
расширение функциональности.

Ядро (core/)

В каталоге core расположена логика работы с файлами и их метаданными:

FileIntegrityEngine — центральный класс ядра; управляет процессами
сканирования, проверки подписи, взаимодействует с хешером (IHasher)
и хранилищем (IStorage).

FileScanner — выполняет постраничное чтение файла, исключает
каталоги в соответствии с правилами фильтрации и формирует список
метаданных (FileMetadata).

FileMetadata — структура, описывающая метаинформацию (путь, размер,
владельца, права доступа и т. п.) для каждого файла.

FileStatus — перечисление возможных состояний файла (Ok,
Changed, Error и т. д.).

IHasher — абстрактный интерфейс для хеширования; в проекте
реализован вариант QtHasher для SHA‑256.

IStorage — абстрактный интерфейс для хранилища; реализация
адаптеров для работы с SQLite находится в каталоге storage.

ScanSummary — краткий отчёт о результатах сканирования (количество
файлов, список изменённых и т. д.).

Работа с базой данных (storage/)

DatabaseManager — класс, управляющий соединением с SQLite. Он
открывает базу, создаёт таблицы (если они отсутствуют), выполняет
проверку версии схемы, добавляет колонки при обновлении и обеспечивает
атомарность операций (транзакции). В таблице files хранятся
характеристики каждого файла, включая путь, хеш, права доступа,
владельца, статус, подпись HMAC и метки времени updated_at и
last_checked. Таблица scan_history содержит историю изменений.

QtStorageAdapter — адаптер между абстрактным интерфейсом IStorage
и классом DatabaseManager. Обеспечивает загрузку/сохранение
настроек интерфейса и истории файлов.

Графический интерфейс (gui/)

MainWindow — главное окно, содержащее меню, панели инструментов,
виджеты для вывода Hex Viewer, Heatmap View, Audio View и File Info,
а также область для журнала/истории.

FileMonitor — компонент, отвечающий за сканирование директорий,
фильтрацию и управление работой сканирующего потока.

ScanWorker — класс, наследующий QObject и выполняющий операции
сканирования в отдельном потоке (QThread), чтобы не блокировать
графический интерфейс.

Notifier — реализует систему уведомлений: выводит сообщения в
системный трей или отправляет уведомления по электронной почте о
изменении состояния файла.

QtHasher — реализация хешера IHasher c использованием
QCryptographicHash (SHA‑256).

main.cpp — точка входа; инициализирует приложение Qt, загружает
настройки, создаёт главное окно и запускает цикл обработки
событий.
newtab

Зависимости

Для сборки и работы проекта потребуются следующие компоненты:

C++17 — основной язык разработки; проект использует
стандартные библиотеки и возможности современного C++.

Qt 6 (Qt Widgets) — кросс‑платформенный фреймворк для GUI;
виджеты Qt обеспечивают визуальные элементы и взаимодействие с
пользователем.

SQLite — легковесная, встроенная СУБД, не требующая отдельного
серверного процесса; используется для хранения метаданных файлов,
истории сканирования и пользовательских настроек.

OpenSSL или библиотека Qt для HMAC SHA‑256 — вычисляет
криптографические подписи; в проекте задействованы функции QCryptographicHash.

CMake/Qt Creator — система сборки; генерирует сборочные скрипты.

AppImageTool — упаковывает приложение вместе со всеми
зависимостями в единый исполняемый файл для Linux.

Сборка и запуск
Cборка из исходников

Клонируйте репозиторий:

git clone https://example.com/your-repo.git
cd your-repo/FIM


Установите Qt 6 и инструменты разработчика (CMake, Ninja или Make).

Создайте build‑каталог и выполните сборку:

mkdir build && cd build
cmake .. -DCMAKE_BUILD_TYPE=Release -DCMAKE_PREFIX_PATH=/path/to/Qt
cmake --build . --config Release


Запустите приложение:

./fim

Использование готового AppImage

Загрузите файл FIM-x.y.z.AppImage (напр. из раздела Releases).

Сделайте его исполняемым:

chmod +x FIM-x.y.z.AppImage


Запустите, щёлкнув по нему или выполнив ./FIM-x.y.z.AppImage.

Использование

Запуск и открытие файла. После запуска откроется главное окно
приложения. Выберите пункт меню Файл → Открыть файл…, выберите
нужный бинарный файл.

Hex Viewer. По умолчанию открывается шестнадцатеричный вид, где
можно прокручивать и исследовать байты файла.

Heatmap View. Перейдите на вкладку «Heatmap» и нажмите
«Обновить». Изменяйте ползунок «Ширина карты», чтобы увеличить или
уменьшить разрешение тепловой карты.

Audio View. На вкладке «Audio» нажмите «Play» для
воспроизведения содержимого файла в виде звукового сигнала.

File Info. Вкладка «Info» показывает путь, размер файла и
расширение.

Настройки. Перейдите в Меню → Настройки, чтобы изменить тему
интерфейса, ширину тепловой карты и режим уведомлений. Настройки
сохраняются автоматически.

История. В правой части окна отображаются последние загруженные
файлы и результаты сканирования. Повторный запуск программы
автоматически восстанавливает эту информацию.
